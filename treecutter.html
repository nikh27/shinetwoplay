<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>Timber Chop! - 2 Player</title>
<link href="https://fonts.googleapis.com/css2?family=Bungee&family=Bungee+Shade&family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#0a0a14;font-family:'Fredoka',sans-serif;touch-action:manipulation;-webkit-tap-highlight-color:transparent;user-select:none}
#game{position:relative;width:100%;max-width:480px;height:100vh;height:100dvh;margin:0 auto;overflow:hidden}

/* ‚ïê‚ïê‚ïê BACKGROUND ‚ïê‚ïê‚ïê */
.bg-top{position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,#0b0e1a 0%,#121830 30%,#162050 70%,#1a3060 100%);z-index:0}
.bg-bot{position:absolute;bottom:0;left:0;right:0;height:50%;background:linear-gradient(0deg,#0b0e1a 0%,#121830 30%,#162050 70%,#1a3060 100%);z-index:0}

/* Stars with blinking */
#stars{position:absolute;inset:0;z-index:1}
.star{position:absolute;background:#fff;border-radius:50%}
.star-b1{animation:blink1 1.8s ease-in-out infinite}
.star-b2{animation:blink2 2.5s ease-in-out infinite .7s}
.star-b3{animation:blink3 3s ease-in-out infinite 1.2s}
@keyframes blink1{0%,100%{opacity:.1;transform:scale(.5)}50%{opacity:1;transform:scale(1.3)}}
@keyframes blink2{0%,100%{opacity:.15;transform:scale(.6)}50%{opacity:.9;transform:scale(1.2)}}
@keyframes blink3{0%,100%{opacity:.2}50%{opacity:.7}}

/* Moon removed */

/* Ground - clean solid strips */
.gnd{position:absolute;left:0;right:0;z-index:5}
.gnd-b{bottom:0;height:40px;background:linear-gradient(180deg,#3a7d34 0%,#2d6b28 30%,#1e4d1a 100%)}
.gnd-b::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:#4caf50}
.gnd-t{top:0;height:40px;background:linear-gradient(0deg,#3a7d34 0%,#2d6b28 30%,#1e4d1a 100%)}
.gnd-t::after{content:'';position:absolute;bottom:0;left:0;right:0;height:3px;background:#4caf50}

.mid-line{position:absolute;top:50%;left:0;right:0;height:1px;background:rgba(255,255,255,.03);z-index:6}

/* ‚ïê‚ïê‚ïê TREE ‚ïê‚ïê‚ïê
   VISIBLE = 6 blocks per player half.
   P1's half at bottom, P2's half at top.
   Each block = 56px tall (matches player height).
   Branches extend outward with overflow:visible.
   Crown shows ONLY above the topmost visible block.
   Stump at bottom, connects to ground.
‚ïê‚ïê‚ïê */

/* Clip wrappers: each half stays in its own 50%. Horizontal overflow allowed for branches via negative inset */
.tree-clip{position:absolute;left:0;right:0;z-index:10;clip-path:inset(0px -120px 0px -120px)}
.tree-clip.tc1{bottom:0;height:50%}
.tree-clip.tc2{top:0;height:50%}

#tree-p1,#tree-p2{position:absolute;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;overflow:visible}
#tree-p1{bottom:40px}
#tree-p2{top:40px}

/* Block = 56√ó56 */
.blk{position:relative;width:48px;height:56px;flex-shrink:0;overflow:visible}
.blk-wood{width:100%;height:100%;background:linear-gradient(90deg,#4a2c16 0%,#6d4525 10%,#8a6030 30%,#9e7040 50%,#8a6030 70%,#6d4525 90%,#4a2c16 100%);border-left:2px solid #3a1e0a;border-right:2px solid #3a1e0a;position:relative}
.blk-wood::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;border-bottom:1px solid rgba(0,0,0,.08)}

/* Branch - visible, not clipped */
.br{position:absolute;top:14px;width:44px;height:14px;z-index:15;overflow:visible}
.br.bl{right:100%;margin-right:-2px}
.br.brt{left:100%;margin-left:-2px}
.br-w{width:100%;height:100%;border-radius:6px;background:linear-gradient(180deg,#9e7040,#7a5030 50%,#5a3520);border:1.5px solid #3a1e0a}
.br.bl .br-w{border-radius:6px 0 0 6px;border-right:none}
.br.brt .br-w{border-radius:0 6px 6px 0;border-left:none}

/* Leaf on branch */
.br-lf{position:absolute;top:-14px;width:40px;height:24px;overflow:visible}
.br-lf-main{width:100%;height:100%;background:radial-gradient(ellipse at 50% 55%,#5cb85c 10%,#4caf50 40%,#388e3c 70%,#2e7d32 100%);border-radius:50%;border:1.5px solid #1b5e20}
.br-lf-hi{position:absolute;top:3px;width:22px;height:12px;background:radial-gradient(ellipse,#81c784,#66bb6a);border-radius:50%;opacity:.7}
.br.bl .br-lf{right:-4px}
.br.bl .br-lf-hi{right:6px}
.br.brt .br-lf{left:-4px}
.br.brt .br-lf-hi{left:6px}

/* P2 branches: leaves go upward (P2 is upside-down, so from their view branches should point up) */
.blk.p2b .br-lf{top:auto;bottom:-14px}

/* Crown - at top of visible tree */
.crown{width:72px;height:42px;position:relative;margin-bottom:-2px;z-index:16;overflow:visible}
.crown-base{width:100%;height:100%;background:radial-gradient(ellipse at 50% 60%,#5cb85c 0%,#43a047 40%,#2e7d32 70%,#1b5e20 100%);border-radius:50% 50% 10% 10%;border:2px solid #1b5e20;border-bottom:none}
.crown-tip{position:absolute;top:-14px;left:50%;transform:translateX(-50%);width:44px;height:28px;background:radial-gradient(ellipse,#66bb6a 20%,#4caf50 55%,#388e3c 100%);border-radius:50%;border:1.5px solid #2e7d32}

/* P2 crown: flipped upside down so it faces P2's direction */
.crown.p2-crown{margin-bottom:0;margin-top:-2px;transform:scaleY(-1)}

/* Stump - connects to ground */
.stump{width:58px;height:12px;background:linear-gradient(180deg,#5a3520,#3a1e0a);border-radius:0 0 5px 5px;margin-top:-1px;z-index:16}

/* Active block glow */
.blk.act1{box-shadow:inset 0 0 0 2px rgba(231,76,90,.3);border-radius:2px}
.blk.act2{box-shadow:inset 0 0 0 2px rgba(59,130,246,.3);border-radius:2px}

/* Done text (when all 100 cut) */
.done-txt{font-family:'Bungee',cursive;font-size:11px;letter-spacing:2px;padding:4px 0}
.done-txt.d1{color:#e74c5a}
.done-txt.d2{color:#3b82f6}

/* Fly animation */
.blk.fly-l{animation:flyL .22s ease-in forwards;z-index:20}
.blk.fly-r{animation:flyR .22s ease-in forwards;z-index:20}
@keyframes flyL{to{transform:translate(-110px,20px) rotate(-25deg);opacity:0}}
@keyframes flyR{to{transform:translate(110px,20px) rotate(25deg);opacity:0}}

/* ‚ïê‚ïê‚ïê PLAYERS ‚ïê‚ïê‚ïê */
.pl{position:absolute;z-index:20;width:48px;height:62px;transition:left .06s ease-out}
.pi{position:relative;width:100%;height:100%}

/* P1 bottom - feet on ground */
.pl.p1{bottom:40px}
.pl.p1.sl{left:calc(50% - 72px)}
.pl.p1.sr{left:calc(50% + 24px)}
.pl.p1.sr .pi{transform:scaleX(-1)}

/* P2 top - upside down */
.pl.p2{top:40px}
.pl.p2.sl{left:calc(50% - 72px)}
.pl.p2.sr{left:calc(50% + 24px)}
.pl.p2 .pi{transform:scaleY(-1)}
.pl.p2.sr .pi{transform:scaleX(-1) scaleY(-1)}

/* ‚îÄ‚îÄ Character Parts ‚îÄ‚îÄ */
/* Head + hat combined */
.ch-head{position:absolute;top:0;left:50%;transform:translateX(-50%);width:24px;height:28px;z-index:3}
.ch-hat{position:absolute;top:0;left:50%;transform:translateX(-50%);width:28px;height:12px;border-radius:6px 6px 2px 2px;z-index:2}
.ch-brim{position:absolute;top:9px;left:50%;transform:translateX(-50%);width:32px;height:5px;border-radius:3px;z-index:2}
.p1 .ch-hat,.p1 .ch-brim{background:#e74c5a;border:1px solid #c0392b}
.p2 .ch-hat,.p2 .ch-brim{background:#3b82f6;border:1px solid #1d4ed8}
.ch-face{position:absolute;top:12px;left:50%;transform:translateX(-50%);width:22px;height:18px;background:radial-gradient(ellipse at 45% 40%,#ffe0b2,#ffc88a);border-radius:50% 50% 40% 40%;border:1.5px solid #d4a06a;z-index:1}
.ch-eye{position:absolute;width:3.5px;height:4px;background:#1a1210;border-radius:50%;top:5px}
.ch-eye::after{content:'';position:absolute;top:.5px;left:.5px;width:1.5px;height:1.5px;background:rgba(255,255,255,.6);border-radius:50%}
.ch-eye.el{left:4px}.ch-eye.er{right:4px}
.ch-smile{position:absolute;bottom:3px;left:50%;transform:translateX(-50%);width:6px;height:3px;border-radius:0 0 3px 3px;background:#c07050}

/* Body */
.ch-body{position:absolute;top:28px;left:50%;transform:translateX(-50%);width:24px;height:16px;border-radius:3px 3px 1px 1px;z-index:1}
.p1 .ch-body{background:linear-gradient(180deg,#e74c5a,#d43c48);border:1px solid #b8303e;border-bottom:none}
.p2 .ch-body{background:linear-gradient(180deg,#3b82f6,#2b6ce6);border:1px solid #1d4ed8;border-bottom:none}
.ch-belt{position:absolute;top:42px;left:50%;transform:translateX(-50%);width:26px;height:4px;background:#5d4037;border-radius:1px;z-index:2}
.ch-buckle{position:absolute;top:41px;left:50%;transform:translateX(-50%);width:5px;height:6px;background:#ffd54f;border-radius:1px;z-index:3}

/* Arms - close to body, no gap */
.ch-arm{position:absolute;top:29px;width:9px;height:16px;border-radius:4px;z-index:0}
.p1 .ch-arm{background:#d43c48;border:1px solid #b8303e}
.p2 .ch-arm{background:#2b6ce6;border:1px solid #1d4ed8}
.ch-arm.al{left:2px}.ch-arm.ar{right:2px}
.ch-hand{position:absolute;bottom:-2px;left:50%;transform:translateX(-50%);width:7px;height:7px;background:#ffc88a;border-radius:50%;border:1px solid #d4a06a}

/* Axe - attached to right arm, no gap */
.ch-axe{position:absolute;top:22px;right:-6px;z-index:25;transform-origin:70% 90%}
.axe-shaft{width:3px;height:26px;background:linear-gradient(90deg,#a07848,#c09868,#a07848);border-radius:1.5px;border:1px solid #806030}
.axe-head{position:absolute;top:-2px;left:-6px;width:16px;height:11px}
.axe-metal{width:100%;height:100%;background:linear-gradient(180deg,#e0e4e8 0%,#c0c8d0 30%,#a0aab4 60%,#8090a0 100%);clip-path:polygon(10% 50%,35% 0%,100% 0%,100% 100%,35% 100%);border:1px solid #708090}
.axe-edge{position:absolute;right:0;top:1px;bottom:1px;width:2px;background:rgba(255,255,255,.4)}

/* Legs */
.ch-legs{position:absolute;top:44px;left:50%;transform:translateX(-50%);display:flex;gap:2px;z-index:0}
.ch-leg{width:10px;height:18px;background:#1a2e4a;border-radius:0 0 3px 3px;border:1px solid #0e1a30;border-top:none;position:relative}
.ch-boot{position:absolute;bottom:0;left:-1px;width:12px;height:6px;background:#3e2720;border-radius:0 0 3px 3px;border:1px solid #2a1a14;border-top:none}

/* ‚ïê‚ïê‚ïê ANIMATIONS ‚ïê‚ïê‚ïê */
/* Chop: wind-up ‚Üí big slam + body lunge + bounce */
.pl.chop .ch-axe{animation:swing .2s cubic-bezier(.2,.8,.3,1)}
@keyframes swing{0%{transform:rotate(10deg)}30%{transform:rotate(20deg)}55%{transform:rotate(-75deg)}100%{transform:rotate(0)}}
.pl.chop .ch-body{animation:chopLunge .2s ease-out}
@keyframes chopLunge{0%,100%{transform:translateX(-50%)}45%{transform:translateX(-50%) translateX(3px) rotate(5deg)}}
.pl.chop .ch-arm.ar{animation:armReach .2s ease-out}
@keyframes armReach{0%,100%{transform:rotate(-8deg)}45%{transform:rotate(-22deg) translateX(2px)}}
.pl.chop{animation:chopBounce .2s ease-out}
@keyframes chopBounce{0%,100%{transform:translateY(0)}45%{transform:translateY(-3px)}}

.pl.hit{animation:hitShake .4s ease}
@keyframes hitShake{0%,100%{transform:translateX(0)}10%{transform:translateX(-7px) rotate(-2deg)}20%{transform:translateX(7px) rotate(2deg)}30%{transform:translateX(-5px)}40%{transform:translateX(5px)}50%{transform:translateX(-3px)}60%{transform:translateX(3px)}}

.pl.stunned{opacity:.2;filter:grayscale(.8) brightness(.5);transition:opacity .15s,filter .15s}
.pl.wake{animation:wakeUp .3s ease-out forwards}
@keyframes wakeUp{0%{opacity:.2;filter:grayscale(.8)}50%{opacity:1;filter:brightness(1.3)}100%{opacity:1;filter:none}}

/* ‚ïê‚ïê‚ïê TAP ZONES ‚ïê‚ïê‚ïê */
.tap{position:absolute;z-index:40;width:50%;cursor:pointer}
#tp1l{bottom:0;left:0;height:50%}
#tp1r{bottom:0;right:0;height:50%}
#tp2l{top:0;left:0;height:50%}
#tp2r{top:0;right:0;height:50%}

/* ‚ïê‚ïê‚ïê SCOREBOARD ‚ïê‚ïê‚ïê */
#sb{position:absolute;top:50%;left:5px;transform:translateY(-50%);z-index:60;display:flex;flex-direction:column;align-items:center;gap:2px;background:rgba(0,0,0,.72);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:8px 10px;min-width:58px;box-shadow:0 4px 20px rgba(0,0,0,.5)}
.sb-b{text-align:center}
.sb-l{font-size:8px;font-weight:700;letter-spacing:2px}
.sb-l.c1{color:#ff6b6b}.sb-l.c2{color:#60a5fa}
.sb-v{font-family:'Bungee',cursive;font-size:20px;color:#fff;line-height:1.1;text-shadow:0 2px 3px rgba(0,0,0,.3)}
.sb-v.bump{animation:sBump .15s ease-out}
@keyframes sBump{50%{transform:scale(1.3)}}
.sb-bar{width:38px;height:3px;background:rgba(255,255,255,.08);border-radius:2px;margin-top:1px;overflow:hidden}
.sb-f{height:100%;border-radius:2px;transition:width .2s;width:0}
.sb-f.f1{background:linear-gradient(90deg,#e74c5a,#ff6b6b)}.sb-f.f2{background:linear-gradient(90deg,#3b82f6,#60a5fa)}
.sb-vs{font-family:'Bungee',cursive;font-size:7px;color:rgba(255,255,255,.12);letter-spacing:2px;margin:1px 0}
.sb-rem{font-size:7px;color:rgba(255,255,255,.25);margin-top:1px}

/* Stun text */
.stxt{position:absolute;left:50%;transform:translateX(-50%);z-index:65;font-family:'Bungee',cursive;font-size:13px;color:#ff5252;text-shadow:0 0 8px rgba(255,0,0,.4),0 2px 4px rgba(0,0,0,.5);pointer-events:none;opacity:0;transition:opacity .12s;letter-spacing:2px}
.stxt.on{opacity:1;animation:stPulse .4s ease-in-out infinite}
@keyframes stPulse{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.06)}}
#st1{bottom:108px}
#st2{top:108px}

/* ‚ïê‚ïê‚ïê FX ‚ïê‚ïê‚ïê */
#fx{position:absolute;inset:0;z-index:30;pointer-events:none;overflow:hidden}
.chip{position:absolute;animation:chipFly .4s ease-out forwards}
@keyframes chipFly{0%{opacity:1;transform:translate(0,0) rotate(0) scale(1)}100%{opacity:0;transform:translate(var(--dx),var(--dy)) rotate(var(--dr)) scale(0)}}
.pop{position:absolute;font-family:'Bungee',cursive;font-size:17px;pointer-events:none;z-index:35;text-shadow:0 2px 5px rgba(0,0,0,.4);animation:popUp .5s ease-out forwards}
.pop.c1{color:#ff6b6b}.pop.c2{color:#60a5fa}
@keyframes popUp{0%{opacity:1;transform:scale(.4)}20%{transform:scale(1.1)}100%{opacity:0;transform:translateY(-30px) scale(.6)}}
.xm{position:absolute;font-family:'Bungee',cursive;font-size:26px;color:#ff1744;pointer-events:none;z-index:35;text-shadow:0 0 10px rgba(255,0,0,.5);animation:xPop .5s ease-out forwards}
@keyframes xPop{0%{opacity:1;transform:scale(.2)}15%{transform:scale(1.2)}100%{opacity:0;transform:translateY(-25px) scale(.5)}}

/* Cut slash effect */
.cut-slash{position:absolute;height:3px;background:linear-gradient(90deg,transparent,rgba(255,255,200,.7),rgba(255,255,255,.9),rgba(255,255,200,.7),transparent);pointer-events:none;z-index:36;animation:slashFlash .18s ease-out forwards}
@keyframes slashFlash{0%{opacity:1;transform:scaleX(.2)}40%{opacity:1;transform:scaleX(1)}100%{opacity:0;transform:scaleX(1.3)}}

/* Dust puff */
.dust{position:absolute;border-radius:50%;background:radial-gradient(circle,rgba(160,130,90,.4),transparent);pointer-events:none;animation:dustPuff .35s ease-out forwards}
@keyframes dustPuff{0%{opacity:.7;transform:scale(.3)}100%{opacity:0;transform:scale(2)}}

/* Falling wood pieces on cut */
.fall-piece{position:absolute;pointer-events:none;z-index:32;animation:fallDown var(--fall-dur) ease-in forwards}
@keyframes fallDown{0%{opacity:1;transform:translate(0,0) rotate(0)}60%{opacity:.8}100%{opacity:0;transform:translate(var(--fx),var(--fy)) rotate(var(--fr))}}

/* ‚ïê‚ïê‚ïê OVERLAYS ‚ïê‚ïê‚ïê */
.ov{position:absolute;inset:0;z-index:100;display:flex;align-items:center;justify-content:center;background:rgba(5,5,12,.88);backdrop-filter:blur(10px);animation:fadeIn .25s ease}
.ov.hidden{display:none}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.ov-box{text-align:center;color:#fff;display:flex;flex-direction:column;align-items:center;gap:14px;padding:0 24px}
.title{font-family:'Bungee Shade',cursive;font-size:36px;color:#ffd700;text-shadow:0 4px 0 rgba(0,0,0,.3),0 0 20px rgba(255,215,0,.1);line-height:1.1;animation:titlePop .6s ease-out}
@keyframes titlePop{0%{transform:scale(0);opacity:0}60%{transform:scale(1.06)}100%{transform:scale(1);opacity:1}}
.sub{font-size:13px;color:rgba(255,255,255,.6);line-height:1.9}.sub b{color:#fff}
.btn{padding:13px 44px;border:none;border-radius:50px;background:linear-gradient(180deg,#ffd700,#ffab00);color:#1a1a2e;font-family:'Bungee',cursive;font-size:15px;cursor:pointer;box-shadow:0 4px 0 #b8860b,0 6px 14px rgba(0,0,0,.3);transition:transform .06s;letter-spacing:1px}
.btn:active{transform:translateY(3px);box-shadow:0 1px 0 #b8860b}
.hint{font-size:9px;color:rgba(255,255,255,.2);letter-spacing:1px;line-height:2.2}

.win-t{font-family:'Bungee Shade',cursive;font-size:28px;text-shadow:0 4px 0 rgba(0,0,0,.3);animation:titlePop .5s ease-out}
.win-t.wc1{color:#e74c5a}.win-t.wc2{color:#3b82f6}
.trophy{font-size:48px;animation:tBounce .7s ease-out}
@keyframes tBounce{0%{transform:scale(0) rotate(-12deg)}45%{transform:scale(1.2) rotate(4deg)}65%{transform:scale(.92)}100%{transform:scale(1)}}
.fin-sc{display:flex;gap:20px;align-items:center}
.fin-sc .sb-v{font-size:26px}

.confetti{position:absolute;z-index:110;opacity:.9;animation:cFall var(--dur) ease-in forwards}
@keyframes cFall{0%{transform:translateY(var(--y0)) rotate(0);opacity:1}100%{transform:translateY(100vh) rotate(var(--rot));opacity:0}}

#exit-btn{position:absolute;top:50%;right:5px;transform:translateY(-50%);z-index:200;background:rgba(255,255,255,.06);color:rgba(255,255,255,.3);border:1px solid rgba(255,255,255,.06);border-radius:8px;padding:4px 9px;font-family:'Bungee',cursive;font-size:8px;cursor:pointer;letter-spacing:2px;backdrop-filter:blur(4px)}


@media(max-height:600px){.blk{height:44px;width:40px}.gnd-b,.gnd-t{height:32px}.pl.p1{bottom:32px}.pl.p2{top:32px}#tree-p1{bottom:32px}#tree-p2{top:32px}.pl{width:40px;height:54px}}
</style>
</head>
<body>
<div id="game">
  <div class="bg-top"></div><div class="bg-bot"></div>
  <div id="stars"></div>
  <div class="gnd gnd-t"></div><div class="gnd gnd-b"></div>
  <div class="mid-line"></div>

  <div id="tp1l" class="tap"></div><div id="tp1r" class="tap"></div>
  <div id="tp2l" class="tap"></div><div id="tp2r" class="tap"></div>

  <button id="exit-btn">EXIT</button>

  <div id="sb">
    <div class="sb-b"><div class="sb-l c2">P2</div><div class="sb-v" id="sv2">0</div><div class="sb-bar"><div class="sb-f f2" id="bf2"></div></div><div class="sb-rem" id="rm2">100 left</div></div>
    <div class="sb-vs">VS</div>
    <div class="sb-b"><div class="sb-l c1">P1</div><div class="sb-v" id="sv1">0</div><div class="sb-bar"><div class="sb-f f1" id="bf1"></div></div><div class="sb-rem" id="rm1">100 left</div></div>
  </div>

  <div class="stxt" id="st1">STUNNED!</div>
  <div class="stxt" id="st2">STUNNED!</div>

  <!-- Tree containers: clipped to each half so trees don't cross center -->
  <div class="tree-clip tc2"><div id="tree-p2"></div></div>
  <div class="tree-clip tc1"><div id="tree-p1"></div></div>

  <!-- Players -->
  <div class="pl p1 sl" id="pl1"><div class="pi">
    <div class="ch-head">
      <div class="ch-hat"></div><div class="ch-brim"></div>
      <div class="ch-face"><div class="ch-eye el"></div><div class="ch-eye er"></div><div class="ch-smile"></div></div>
    </div>
    <div class="ch-body"></div><div class="ch-belt"></div><div class="ch-buckle"></div>
    <div class="ch-arm al"><div class="ch-hand"></div></div>
    <div class="ch-arm ar"><div class="ch-hand"></div></div>
    <div class="ch-axe"><div class="axe-shaft"></div><div class="axe-head"><div class="axe-metal"></div><div class="axe-edge"></div></div></div>
    <div class="ch-legs"><div class="ch-leg"><div class="ch-boot"></div></div><div class="ch-leg"><div class="ch-boot"></div></div></div>
  </div></div>

  <div class="pl p2 sl" id="pl2"><div class="pi">
    <div class="ch-head">
      <div class="ch-hat"></div><div class="ch-brim"></div>
      <div class="ch-face"><div class="ch-eye el"></div><div class="ch-eye er"></div><div class="ch-smile"></div></div>
    </div>
    <div class="ch-body"></div><div class="ch-belt"></div><div class="ch-buckle"></div>
    <div class="ch-arm al"><div class="ch-hand"></div></div>
    <div class="ch-arm ar"><div class="ch-hand"></div></div>
    <div class="ch-axe"><div class="axe-shaft"></div><div class="axe-head"><div class="axe-metal"></div><div class="axe-edge"></div></div></div>
    <div class="ch-legs"><div class="ch-leg"><div class="ch-boot"></div></div><div class="ch-leg"><div class="ch-boot"></div></div></div>
  </div></div>

  <div id="fx"></div>

  <!-- Overlays -->
  <div id="ov-start" class="ov">
    <div class="ov-box">
      <h1 class="title">TIMBER<br>CHOP!</h1>
      <p class="sub">2 Player ¬∑ Chop 100 Logs!<br>Tap <b>left</b> or <b>right</b> to chop<br>Branch above your head? <b>STUNNED 2s!</b><br>No branch above? <b>Safe chop +1</b><br>First to chop all <b>100</b> wins!</p>
      <button class="btn" id="btn-go">START</button>
      <div class="hint">P1 (Red) bottom half ‚Äî A / D<br>P2 (Blue) top half ‚Äî ‚Üê / ‚Üí<br>Same tree ¬∑ Same difficulty ¬∑ Pure speed!</div>
    </div>
  </div>

  <div id="ov-win" class="ov hidden">
    <div class="ov-box">
      <div class="trophy">üèÜ</div>
      <h1 class="win-t" id="wt">P1 WINS!</h1>
      <div class="fin-sc">
        <div class="sb-b"><div class="sb-l c1">P1</div><div class="sb-v" id="fw1">0</div></div>
        <div class="sb-vs">‚Äî</div>
        <div class="sb-b"><div class="sb-l c2">P2</div><div class="sb-v" id="fw2">0</div></div>
      </div>
      <button class="btn" id="btn-again">PLAY AGAIN</button>
    </div>
  </div>
</div>

<script>
(function(){
'use strict';

const GOAL = 100;
const STUN = 2000;
const BR_CH = 0.55;
const MAX_NB = 2;

/* Dynamic: calculate how many blocks fit from ground to center line */
function calcVis(){
  const h = window.innerHeight || document.documentElement.clientHeight;
  const blkH = h <= 600 ? 44 : 56;
  const gndH = h <= 600 ? 32 : 40;
  const avail = Math.floor(h / 2) - gndH - 14; /* half screen - ground - stump */
  return Math.max(2, Math.ceil(avail / blkH) + 1);
}

/*
  ‚ïê‚ïê‚ïê ARCHITECTURE ‚ïê‚ïê‚ïê

  1. Pre-generate branches[0..99] at game start.
     BOTH players face the EXACT SAME array = FAIR.

  2. Each player has a `cut` counter (0‚Üí100).
     Their active block = branches[cut].
     They see blocks from `cut` to `cut + VIS - 1`.

  3. Mechanic:
     - Player stands on LEFT or RIGHT side of tree.
     - Active block is the one at their level (closest to them).
     - If active block has a BRANCH on the SAME SIDE as the player,
       the branch is above their head ‚Üí hits them ‚Üí STUNNED.
     - If no branch on their side ‚Üí safe chop ‚Üí block removed ‚Üí cut++.

  4. Each player's tree is rendered INDEPENDENTLY.
     P1 chopping never affects P2's display.

  5. When cut reaches 100: tree is GONE. First to 100 wins.
     Visually: tree shrinks as fewer blocks remain.
     At 95+: only a few blocks left.
     At 100: empty, just "ALL CUT!" text.
*/

let branches = [];

const state = {
  on: false,
  p1: { cut:0, side:'left', cdEnd:0 },
  p2: { cut:0, side:'left', cdEnd:0 },
};

const $ = s => document.querySelector(s);
const D = {
  game:$('#game'),
  t1:$('#tree-p1'), t2:$('#tree-p2'),
  pl1:$('#pl1'), pl2:$('#pl2'),
  sv1:$('#sv1'), sv2:$('#sv2'),
  bf1:$('#bf1'), bf2:$('#bf2'),
  rm1:$('#rm1'), rm2:$('#rm2'),
  st1:$('#st1'), st2:$('#st2'),
  fx:$('#fx'),
  ovS:$('#ov-start'), ovW:$('#ov-win'),
  wt:$('#wt'), fw1:$('#fw1'), fw2:$('#fw2'),
};

/* ‚ïê‚ïê‚ïê STARS ‚ïê‚ïê‚ïê */
(function(){
  const c=$('#stars');
  const cls=['star-b1','star-b2','star-b3','','','',''];
  for(let i=0;i<55;i++){
    const s=document.createElement('div');
    s.className='star '+cls[Math.floor(Math.random()*cls.length)];
    const sz=.7+Math.random()*2;
    s.style.width=s.style.height=sz+'px';
    s.style.left=Math.random()*100+'%';
    s.style.top=Math.random()*100+'%';
    s.style.opacity=.1+Math.random()*.5;
    c.appendChild(s);
  }
})();

/* ‚ïê‚ïê‚ïê GENERATE 100 BRANCHES ‚ïê‚ïê‚ïê */
function genAll(){
  branches=[];
  let streak=0;
  for(let i=0;i<GOAL;i++){
    if(streak>=MAX_NB){
      streak=0;
      branches.push(Math.random()<.5?'left':'right');
    } else if(Math.random()<BR_CH){
      streak=0;
      branches.push(Math.random()<.5?'left':'right');
    } else {
      streak++;
      branches.push(null);
    }
  }
}

/* ‚ïê‚ïê‚ïê CREATE BLOCK DOM ‚ïê‚ïê‚ïê */
function mkBlk(br, actCls){
  const el=document.createElement('div');
  el.className='blk'+(actCls?' '+actCls:'');
  const w=document.createElement('div');w.className='blk-wood';
  el.appendChild(w);
  if(br){
    const b=document.createElement('div');
    b.className='br '+(br==='left'?'bl':'brt');
    const bw=document.createElement('div');bw.className='br-w';b.appendChild(bw);
    const lf=document.createElement('div');lf.className='br-lf';
    lf.innerHTML='<div class="br-lf-main"></div><div class="br-lf-hi"></div>';
    b.appendChild(lf);
    el.appendChild(b);
  }
  return el;
}

/* ‚ïê‚ïê‚ïê RENDER TREE FOR PLAYER ‚ïê‚ïê‚ïê */
function renderTree(pl){
  const ps = pl===1 ? state.p1 : state.p2;
  const cont = pl===1 ? D.t1 : D.t2;
  cont.innerHTML='';

  const remaining = GOAL - ps.cut;

  if(remaining <= 0){
    /* All cut! Show done message */
    const d=document.createElement('div');
    d.className='done-txt '+(pl===1?'d1':'d2');
    d.textContent='ALL CUT!';
    cont.appendChild(d);
    /* Still show stump */
    if(pl===1){
      const st=document.createElement('div');st.className='stump';cont.appendChild(st);
    }
    return;
  }

  const vis = calcVis();
  const count = Math.min(vis, remaining);

  if(pl===1){
    /* P1 (bottom): crown on top ONLY if last block is visible and remaining<=3 */
    const topIdx = ps.cut + count - 1;
    if(topIdx >= GOAL - 1 && remaining <= 3){
      const cr=document.createElement('div');cr.className='crown';
      cr.innerHTML='<div class="crown-tip"></div><div class="crown-base"></div>';
      cont.appendChild(cr);
    }
    /* Blocks: top-most first (furthest from player), active last (closest) */
    for(let i=count-1; i>=0; i--){
      const idx = ps.cut + i;
      if(idx>=GOAL) continue;
      const isAct = (i===0);
      cont.appendChild(mkBlk(branches[idx], isAct?'act1':''));
    }
    /* Stump at bottom */
    const st=document.createElement('div');st.className='stump';cont.appendChild(st);
  } else {
    /* P2 (top half): active first (closest to P2 at top), then further away toward center */
    for(let i=0; i<count; i++){
      const idx = ps.cut + i;
      if(idx>=GOAL) continue;
      const isAct = (i===0);
      const blk = mkBlk(branches[idx], isAct?'act2':'');
      blk.classList.add('p2b');
      cont.appendChild(blk);
    }
    /* Crown at bottom ONLY if last block visible and remaining<=3 */
    const botIdx = ps.cut + count - 1;
    if(botIdx >= GOAL - 1 && remaining <= 3){
      const cr=document.createElement('div');cr.className='crown p2-crown';
      cr.innerHTML='<div class="crown-tip"></div><div class="crown-base"></div>';
      cont.appendChild(cr);
    }
  }
}

/* ‚ïê‚ïê‚ïê UI ‚ïê‚ïê‚ïê */
function updUI(){
  D.sv1.textContent=state.p1.cut;
  D.sv2.textContent=state.p2.cut;
  D.bf1.style.width=(state.p1.cut/GOAL*100)+'%';
  D.bf2.style.width=(state.p2.cut/GOAL*100)+'%';
  const r1=GOAL-state.p1.cut, r2=GOAL-state.p2.cut;
  D.rm1.textContent=r1>0?r1+' left':'DONE!';
  D.rm2.textContent=r2>0?r2+' left':'DONE!';
}

function bump(pl){
  const e=pl===1?D.sv1:D.sv2;
  e.classList.remove('bump');void e.offsetWidth;e.classList.add('bump');
  setTimeout(()=>e.classList.remove('bump'),180);
}

function setSide(pl,side){
  const ps=pl===1?state.p1:state.p2;
  const el=pl===1?D.pl1:D.pl2;
  ps.side=side;
  el.classList.remove('sl','sr');
  el.classList.add(side==='left'?'sl':'sr');
}

/* ‚ïê‚ïê‚ïê FX ‚ïê‚ïê‚ïê */
function chips(x,y,c1,c2){
  for(let i=0;i<8;i++){
    const p=document.createElement('div');p.className='chip';
    const sz=2+Math.random()*5;
    p.style.cssText=`width:${sz}px;height:${sz*(.6+Math.random()*.8)}px;background:${Math.random()<.5?c1:c2};left:${x}px;top:${y}px;border-radius:${Math.random()<.3?'50%':'2px'}`;
    p.style.setProperty('--dx',(Math.random()-.5)*100+'px');
    p.style.setProperty('--dy',(Math.random()-.5)*80+'px');
    p.style.setProperty('--dr',(Math.random()-.5)*600+'deg');
    D.fx.appendChild(p);setTimeout(()=>p.remove(),450);
  }
}

function showPop(x,y,pl){
  const e=document.createElement('div');e.className='pop '+(pl===1?'c1':'c2');
  e.textContent='+1';e.style.left=x+'px';e.style.top=y+'px';
  D.fx.appendChild(e);setTimeout(()=>e.remove(),550);
}

function showX(x,y){
  const e=document.createElement('div');e.className='xm';
  e.textContent='‚úï';e.style.left=x+'px';e.style.top=y+'px';
  D.fx.appendChild(e);setTimeout(()=>e.remove(),550);
}

function getActPos(pl){
  const cont=pl===1?D.t1:D.t2;
  const el=cont.querySelector(pl===1?'.act1':'.act2');
  const gr=D.game.getBoundingClientRect();
  if(el){const r=el.getBoundingClientRect();return{x:r.left-gr.left+r.width/2,y:r.top-gr.top+r.height/2}}
  return{x:gr.width/2,y:pl===1?gr.height*.7:gr.height*.3};
}

/* ‚ïê‚ïê‚ïê FALLING PIECES ‚ïê‚ïê‚ïê */
function spawnFallingPieces(x,y,pl){
  const colors=['#9e7040','#6d4525','#c09868','#806030','#5a3520'];
  const dir=pl===1?1:-1; /* P1: fall down, P2: fall up (toward their ground) */
  for(let i=0;i<6;i++){
    const p=document.createElement('div');p.className='fall-piece';
    const w=3+Math.random()*8, h=3+Math.random()*6;
    p.style.cssText=`left:${x-4+(Math.random()-.5)*30}px;top:${y-4+(Math.random()-.5)*10}px;width:${w}px;height:${h}px;background:${colors[Math.floor(Math.random()*colors.length)]};border-radius:${Math.random()<.3?'50%':'2px'}`;
    p.style.setProperty('--fx',(Math.random()-.5)*40+'px');
    p.style.setProperty('--fy',(40+Math.random()*60)*dir+'px');
    p.style.setProperty('--fr',(Math.random()-.5)*360+'deg');
    p.style.setProperty('--fall-dur',(.3+Math.random()*.3)+'s');
    D.fx.appendChild(p);setTimeout(()=>p.remove(),700);
  }
}

/* ‚ïê‚ïê‚ïê CHOP ‚ïê‚ïê‚ïê */
function doChop(pl,side){
  if(!state.on) return;
  const ps=pl===1?state.p1:state.p2;
  const el=pl===1?D.pl1:D.pl2;
  const now=Date.now();
  if(now<ps.cdEnd) return;
  if(ps.cut>=GOAL) return;

  setSide(pl,side);

  const branch = branches[ps.cut];
  const pos = getActPos(pl);

  /* ‚îÄ‚îÄ BRANCH ON YOUR SIDE = hits your head = STUNNED ‚îÄ‚îÄ */
  if(branch === side){
    ps.cdEnd = now + STUN;

    el.classList.remove('hit');void el.offsetWidth;
    el.classList.add('hit','stunned');
    setTimeout(()=>el.classList.remove('hit'),320);

    const stEl=pl===1?D.st1:D.st2;
    stEl.classList.add('on');

    showX(pos.x-10,pos.y-14);
    chips(pos.x,pos.y,'#ff1744','#ff8a80');

    /* Move to safe side */
    setTimeout(()=>setSide(pl,branch==='left'?'right':'left'),180);

    /* Unstun */
    setTimeout(()=>{
      if(!state.on)return;
      el.classList.remove('stunned');
      el.classList.add('wake');
      setTimeout(()=>el.classList.remove('wake'),300);
      stEl.classList.remove('on');
    },STUN);
    return;
  }

  /* ‚îÄ‚îÄ SAFE CHOP ‚îÄ‚îÄ */
  el.classList.remove('chop');void el.offsetWidth;
  el.classList.add('chop');
  setTimeout(()=>el.classList.remove('chop'),220);

  /* Double burst of wood chips */
  chips(pos.x,pos.y,'#9e7040','#6d4525');
  chips(pos.x+(side==='left'?8:-8),pos.y+2,'#c09868','#806030');
  showPop(pos.x-6,pos.y-22,pl);

  /* Cut slash across the block */
  const sl=document.createElement('div');sl.className='cut-slash';
  sl.style.cssText=`left:${pos.x-35}px;top:${pos.y-1}px;width:70px`;
  D.fx.appendChild(sl);setTimeout(()=>sl.remove(),200);

  /* Dust puff at impact point */
  const du=document.createElement('div');du.className='dust';
  du.style.cssText=`left:${pos.x-12}px;top:${pos.y-12}px;width:24px;height:24px`;
  D.fx.appendChild(du);setTimeout(()=>du.remove(),400);

  /* Falling pieces from the cut block */
  const cont=pl===1?D.t1:D.t2;
  spawnFallingPieces(pos.x, pos.y, pl);

  /* Fly the active block away */
  const actEl=cont.querySelector(pl===1?'.act1':'.act2');
  if(actEl) actEl.classList.add(side==='left'?'fly-r':'fly-l');

  /* Update after fly animation starts */
  setTimeout(()=>{
    if(!state.on)return;
    ps.cut++;
    updUI();
    renderTree(pl);
    if(ps.cut>=GOAL) endGame(pl);
  },90);

  bump(pl);
}

/* ‚ïê‚ïê‚ïê CONFETTI ‚ïê‚ïê‚ïê */
function confetti(clr){
  const cs=[clr,'#ffd700','#ff6f00','#4caf50','#e040fb','#00bcd4','#fff'];
  for(let i=0;i<50;i++){
    const c=document.createElement('div');c.className='confetti';
    c.style.left=Math.random()*100+'%';
    c.style.width=(4+Math.random()*5)+'px';c.style.height=(5+Math.random()*6)+'px';
    c.style.background=cs[Math.floor(Math.random()*cs.length)];
    c.style.borderRadius=Math.random()<.4?'50%':'2px';
    c.style.setProperty('--y0',(-15-Math.random()*50)+'px');
    c.style.setProperty('--rot',(Math.random()*500-250)+'deg');
    c.style.setProperty('--dur',(1.3+Math.random()*1.4)+'s');
    c.style.animationDelay=Math.random()*.5+'s';
    D.game.appendChild(c);setTimeout(()=>c.remove(),3200);
  }
}

/* ‚ïê‚ïê‚ïê GAME ‚ïê‚ïê‚ïê */
function startGame(){
  state.on=true;
  state.p1={cut:0,side:'left',cdEnd:0};
  state.p2={cut:0,side:'left',cdEnd:0};

  genAll();

  setSide(1,'left');setSide(2,'left');
  D.pl1.classList.remove('stunned','hit','chop','wake');
  D.pl2.classList.remove('stunned','hit','chop','wake');
  D.st1.classList.remove('on');D.st2.classList.remove('on');
  D.fx.innerHTML='';

  updUI();
  renderTree(1);
  renderTree(2);

  D.ovS.classList.add('hidden');
  D.ovW.classList.add('hidden');
}

function endGame(w){
  state.on=false;
  /* Render final state so winner sees empty tree */
  renderTree(w);
  D.wt.textContent='PLAYER '+w+' WINS!';
  D.wt.className='win-t '+(w===1?'wc1':'wc2');
  D.fw1.textContent=state.p1.cut;
  D.fw2.textContent=state.p2.cut;
  setTimeout(()=>{D.ovW.classList.remove('hidden');confetti(w===1?'#e74c5a':'#3b82f6')},300);
}

/* ‚ïê‚ïê‚ïê INPUT ‚ïê‚ïê‚ïê */
function tap(el,fn){el.addEventListener('pointerdown',e=>{e.preventDefault();fn()})}
tap($('#tp1l'),()=>doChop(1,'left'));
tap($('#tp1r'),()=>doChop(1,'right'));
tap($('#tp2l'),()=>doChop(2,'left'));
tap($('#tp2r'),()=>doChop(2,'right'));

document.addEventListener('keydown',e=>{
  if(e.repeat)return;
  switch(e.key){
    case 'a':case 'A':doChop(1,'left');break;
    case 'd':case 'D':doChop(1,'right');break;
    case 'ArrowLeft':e.preventDefault();doChop(2,'left');break;
    case 'ArrowRight':e.preventDefault();doChop(2,'right');break;
  }
});

tap($('#btn-go'),startGame);
tap($('#btn-again'),startGame);
$('#exit-btn').addEventListener('click',()=>window.history.back());
document.addEventListener('touchstart',e=>{if(e.touches.length>1)e.preventDefault()},{passive:false});

/* Initial display */
genAll();renderTree(1);renderTree(2);
})();
</script>
</body>
</html>
