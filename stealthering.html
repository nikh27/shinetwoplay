<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Diamond Heist</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            touch-action: manipulation;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0806;
        }

        .game-container {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: radial-gradient(ellipse 120% 80% at 50% 50%, #2d221a 0%, #1a140f 40%, #0d0a07 70%, #050403 100%);
            overflow: hidden;
        }

        .ambient-light {
            position: absolute; inset: 0;
            background:
                radial-gradient(ellipse 80% 50% at 50% 50%, rgba(255, 220, 180, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 50% 50%, rgba(255, 200, 150, 0.05) 0%, transparent 40%);
            pointer-events: none; z-index: 2;
        }

        .spotlight {
            position: absolute; left: 50%; width: 50vw;
            background: linear-gradient(180deg, rgba(255,245,220,0.12) 0%, rgba(255,235,200,0.06) 30%, rgba(255,225,180,0.02) 60%, transparent 100%);
            pointer-events: none; z-index: 3;
        }
        .spotlight.top { top: 0; height: 50vh; transform: translateX(-50%); clip-path: polygon(35% 0%, 65% 0%, 80% 100%, 20% 100%); }
        .spotlight.bottom { bottom: 0; height: 50vh; transform: translateX(-50%) rotate(180deg); clip-path: polygon(35% 0%, 65% 0%, 80% 100%, 20% 100%); }

        .player-zone {
            position: absolute; left: 0; right: 0; height: 50vh; z-index: 10;
        }
        .player-zone.p1 { top: 0; }
        .player-zone.p2 { bottom: 0; }
        .player-zone.p1::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to bottom, rgba(100, 180, 255, 0.04) 0%, transparent 50%);
            pointer-events: none;
        }
        .player-zone.p2::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to top, rgba(255, 100, 100, 0.04) 0%, transparent 50%);
            pointer-events: none;
        }

        .center-line {
            position: absolute; top: 50%; left: 5%; right: 5%; height: 1px;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.08) 20%, rgba(255,255,255,0.12) 50%, rgba(255,255,255,0.08) 80%, transparent 100%);
            transform: translateY(-50%); z-index: 5;
        }

        /* ===== EXIT BUTTON - top right corner ===== */
        .exit-btn {
            position: absolute;
            top: 12px; right: 12px;
            width: 36px; height: 36px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; z-index: 150;
            transition: all 0.15s;
        }
        .exit-btn svg { width: 14px; height: 14px; }
        .exit-btn:active {
            transform: scale(0.9);
            background: rgba(255,255,255,0.12);
        }

        /* ===== PLAYER INFO PANELS - left P1, right P2 ===== */
        .player-panel {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            z-index: 100;
            padding: 10px 8px;
            background: linear-gradient(160deg, rgba(20,20,25,0.85), rgba(10,10,14,0.9));
            border-radius: 16px;
            box-shadow: 0 6px 24px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.06);
            backdrop-filter: blur(8px);
        }
        .player-panel.p1-panel { left: 8px; }
        .player-panel.p2-panel { right: 8px; }

        .player-avatar {
            width: 36px; height: 36px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid;
            display: flex; align-items: center; justify-content: center;
        }
        .player-panel.p1-panel .player-avatar { border-color: #7ac4ff; background: rgba(122,196,255,0.1); }
        .player-panel.p2-panel .player-avatar { border-color: #ff7a7a; background: rgba(255,122,122,0.1); }
        .player-avatar svg { width: 22px; height: 22px; }

        .player-name {
            font-size: 0.5rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            opacity: 0.6;
            white-space: nowrap;
        }
        .p1-panel .player-name { color: #7ac4ff; }
        .p2-panel .player-name { color: #ff7a7a; }

        .player-score {
            font-size: 1.6rem;
            font-weight: 800;
            line-height: 1;
        }
        .p1-panel .player-score { color: #7ac4ff; text-shadow: 0 0 16px rgba(122,196,255,0.5); }
        .p2-panel .player-score { color: #ff7a7a; text-shadow: 0 0 16px rgba(255,122,122,0.5); }

        /* ===== HANDS - Clean flat style ===== */
        .hand {
            position: absolute; left: 50%;
            width: 18vw; max-width: 110px; min-width: 72px;
            z-index: 20;
            filter: drop-shadow(0 6px 16px rgba(0,0,0,0.6));
        }
        .hand svg { width: 100%; height: auto; }

        .hand.p1-hand {
            top: 6vh;
            transform: translateX(-50%) rotate(180deg);
        }
        .hand.p2-hand {
            bottom: 6vh;
            transform: translateX(-50%);
        }

        .hand.grabbing { animation: grabMove 0.18s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
        .hand.p1-hand.grabbing { animation: grabMoveP1 0.18s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }

        @keyframes grabMove {
            0% { transform: translateX(-50%) translateY(0); }
            100% { transform: translateX(-50%) translateY(calc(-50vh + 25vh)); }
        }
        @keyframes grabMoveP1 {
            0% { transform: translateX(-50%) rotate(180deg) translateY(0); }
            100% { transform: translateX(-50%) rotate(180deg) translateY(calc(-50vh + 25vh)); }
        }

        .hand.retracting { animation: retractMove 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
        .hand.p1-hand.retracting { animation: retractMoveP1 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }

        @keyframes retractMove {
            0% { transform: translateX(-50%) translateY(calc(-50vh + 25vh)); }
            100% { transform: translateX(-50%) translateY(0); }
        }
        @keyframes retractMoveP1 {
            0% { transform: translateX(-50%) rotate(180deg) translateY(calc(-50vh + 25vh)); }
            100% { transform: translateX(-50%) rotate(180deg) translateY(0); }
        }

        /* ===== DISPLAY CASE ===== */
        .display-case {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 15;
            width: 40vw; max-width: 200px; min-width: 140px;
        }
        .display-case svg { width: 100%; height: auto; filter: drop-shadow(0 8px 24px rgba(0,0,0,0.5)); }

        .glass-group { transition: opacity 0.1s ease; }
        .glass-group.hidden { opacity: 0; }

        .diamond-glow {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 24vw; max-width: 120px; aspect-ratio: 1;
            background: radial-gradient(circle, rgba(120,200,255,0.3) 0%, rgba(100,180,255,0.12) 30%, rgba(80,160,255,0.04) 50%, transparent 70%);
            border-radius: 50%;
            animation: glowPulse 2.5s ease-in-out infinite;
            pointer-events: none; z-index: 14;
        }
        @keyframes glowPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
        }
        .diamond-glow.hidden { display: none; }

        /* ===== START SCREEN ===== */
        .start-screen {
            position: fixed; inset: 0;
            background: radial-gradient(ellipse at center, #1a1510 0%, #0d0a07 60%, #050403 100%);
            z-index: 200;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 8vw;
        }
        .start-screen.hidden { display: none; }

        .logo-container { position: relative; margin-bottom: 5vh; }
        .logo-glow {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 45vw; max-width: 200px; aspect-ratio: 1;
            background: radial-gradient(circle, rgba(100,200,255,0.35) 0%, transparent 60%);
            border-radius: 50%; animation: logoGlow 3s ease-in-out infinite;
        }
        @keyframes logoGlow {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
            50% { transform: translate(-50%, -50%) scale(1.4); opacity: 0.9; }
        }
        .logo-diamond { position: relative; width: 28vw; max-width: 120px; height: auto; z-index: 1; }

        .start-title {
            font-size: clamp(1.5rem, 6vw, 2.5rem); font-weight: 800; color: #fff;
            margin-bottom: 1.5vh; text-shadow: 0 0 40px rgba(100,200,255,0.5);
            letter-spacing: 4px; text-transform: uppercase;
        }
        .start-subtitle {
            font-size: clamp(0.75rem, 3vw, 1rem); color: rgba(255,255,255,0.45);
            margin-bottom: 8vh; letter-spacing: 2px;
        }
        .start-btn {
            background: linear-gradient(135deg, #7ac4ff 0%, #5098d9 100%);
            color: #0a1525; font-size: clamp(0.9rem, 4vw, 1.2rem); font-weight: 700;
            padding: 4vw 12vw; border: none; border-radius: 50px; cursor: pointer;
            box-shadow: 0 10px 40px rgba(122,196,255,0.4), inset 0 2px 0 rgba(255,255,255,0.25);
            text-transform: uppercase; letter-spacing: 3px;
        }
        .start-btn:active { transform: scale(0.96); box-shadow: 0 5px 20px rgba(122,196,255,0.4); }

        /* ===== GAME OVER ===== */
        .game-over {
            position: fixed; inset: 0;
            background: radial-gradient(ellipse at center, #1a1510 0%, #0d0a07 60%, #050403 100%);
            z-index: 200; display: none; flex-direction: column; align-items: center; justify-content: center;
            padding: 8vw;
        }
        .game-over.show { display: flex; }

        .winner-crown { font-size: clamp(3rem, 12vw, 5rem); margin-bottom: 3vh; animation: crownBounce 1s ease-in-out infinite; }
        @keyframes crownBounce {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }
        .winner-title {
            font-size: clamp(1.3rem, 5vw, 2rem); font-weight: 800; margin-bottom: 2vh;
            text-transform: uppercase; letter-spacing: 3px;
        }
        .winner-title.p1 { color: #7ac4ff; text-shadow: 0 0 30px rgba(122,196,255,0.6); }
        .winner-title.p2 { color: #ff7a7a; text-shadow: 0 0 30px rgba(255,122,122,0.6); }

        .final-score {
            font-size: clamp(2.5rem, 10vw, 4rem); font-weight: 800; color: white;
            margin-bottom: 6vh; text-shadow: 0 0 30px rgba(255,255,255,0.3);
        }

        /* ===== EFFECTS ===== */
        .round-flash { position: absolute; inset: 0; z-index: 50; pointer-events: none; opacity: 0; }
        .round-flash.p1-win {
            background: radial-gradient(circle at 50% 50%, rgba(122,196,255,0.4) 0%, transparent 55%);
            animation: flashBurst 0.6s ease-out;
        }
        .round-flash.p2-win {
            background: radial-gradient(circle at 50% 50%, rgba(255,122,122,0.4) 0%, transparent 55%);
            animation: flashBurst 0.6s ease-out;
        }
        @keyframes flashBurst {
            0% { opacity: 1; transform: scale(0.6); }
            100% { opacity: 0; transform: scale(2); }
        }

        .penalty-overlay {
            position: absolute; inset: 0;
            background: radial-gradient(circle at 50% 80%, rgba(255,40,40,0.3) 0%, transparent 50%);
            opacity: 0; pointer-events: none; z-index: 25;
        }
        .player-zone.p1 .penalty-overlay {
            background: radial-gradient(circle at 50% 20%, rgba(255,40,40,0.3) 0%, transparent 50%);
        }
        .penalty-overlay.show { animation: penaltyFlash 0.5s ease-out; }
        @keyframes penaltyFlash { 0%, 100% { opacity: 0; } 40% { opacity: 1; } }

        .particle-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            pointer-events: none; z-index: 30;
        }
        .particle { position: absolute; width: 8px; height: 8px; border-radius: 50%; opacity: 0; }
        .particle.animate { animation: particleExplode 0.7s ease-out forwards; }
        @keyframes particleExplode {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- Start Screen -->
    <div class="start-screen" id="startScreen">
        <div class="logo-container">
            <div class="logo-glow"></div>
            <svg class="logo-diamond" viewBox="0 0 100 100">
                <defs>
                    <linearGradient id="logoDia" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#b8ecff"/>
                        <stop offset="50%" style="stop-color:#7ac4ff"/>
                        <stop offset="100%" style="stop-color:#3a7ab8"/>
                    </linearGradient>
                    <filter id="logoGlowF">
                        <feGaussianBlur stdDeviation="2.5" result="blur"/>
                        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                </defs>
                <polygon points="50,5 95,38 50,95 5,38" fill="url(#logoDia)" filter="url(#logoGlowF)"/>
                <polygon points="50,5 72,38 50,55 28,38" fill="rgba(255,255,255,0.4)"/>
                <polygon points="50,5 28,38 5,38" fill="rgba(255,255,255,0.2)"/>
                <circle cx="32" cy="28" r="4" fill="white" opacity="0.85"/>
                <circle cx="26" cy="24" r="2" fill="white" opacity="0.6"/>
            </svg>
        </div>
        <h1 class="start-title">Diamond Heist</h1>
        <p class="start-subtitle">First to grab wins</p>
        <button class="start-btn" id="startBtn">START</button>
    </div>

    <!-- Game Container -->
    <div class="game-container" id="gameContainer">
        <div class="ambient-light"></div>
        <div class="spotlight top"></div>
        <div class="spotlight bottom"></div>
        <div class="center-line"></div>

        <!-- Exit button - top right, circle X -->
        <button class="exit-btn" id="exitBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2.5" stroke-linecap="round">
                <line x1="6" y1="6" x2="18" y2="18"/><line x1="18" y1="6" x2="6" y2="18"/>
            </svg>
        </button>

        <!-- Player 1 Panel - Left side -->
        <div class="player-panel p1-panel">
            <div class="player-avatar">
                <svg viewBox="0 0 40 40" fill="none">
                    <circle cx="20" cy="14" r="8" fill="#7ac4ff" opacity="0.8"/>
                    <path d="M6,36 Q6,24 20,24 Q34,24 34,36" fill="#7ac4ff" opacity="0.6"/>
                </svg>
            </div>
            <span class="player-name">Player 1</span>
            <span class="player-score" id="p1Score">0</span>
        </div>

        <!-- Player 2 Panel - Right side -->
        <div class="player-panel p2-panel">
            <div class="player-avatar">
                <svg viewBox="0 0 40 40" fill="none">
                    <circle cx="20" cy="14" r="8" fill="#ff7a7a" opacity="0.8"/>
                    <path d="M6,36 Q6,24 20,24 Q34,24 34,36" fill="#ff7a7a" opacity="0.6"/>
                </svg>
            </div>
            <span class="player-name">Player 2</span>
            <span class="player-score" id="p2Score">0</span>
        </div>

        <!-- Player Zones -->
        <div class="player-zone p1" id="p1Zone">
            <div class="penalty-overlay" id="p1Penalty"></div>
        </div>
        <div class="player-zone p2" id="p2Zone">
            <div class="penalty-overlay" id="p2Penalty"></div>
        </div>

        <!-- Hand P1 (Top) - Single unified flat hand shape -->
        <div class="hand p1-hand" id="p1Hand">
            <svg viewBox="0 0 120 170" fill="none">
                <defs>
                    <linearGradient id="handG1" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#2a2520"/>
                        <stop offset="50%" stop-color="#1e1a17"/>
                        <stop offset="100%" stop-color="#141210"/>
                    </linearGradient>
                    <linearGradient id="handH1" x1="20%" y1="0%" x2="80%" y2="100%">
                        <stop offset="0%" stop-color="rgba(255,255,255,0.12)"/>
                        <stop offset="100%" stop-color="rgba(255,255,255,0.02)"/>
                    </linearGradient>
                    <filter id="hs1"><feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#000" flood-opacity="0.4"/></filter>
                </defs>
                <!-- Single unified hand silhouette - thief glove -->
                <path d="
                    M42,170 L42,130
                    Q42,118 42,115
                    L36,115 Q22,112 18,100 Q14,88 20,72
                    L22,62 Q26,52 30,50 Q36,46 40,52 L42,60
                    L42,44 Q42,20 38,12 Q36,4 42,0 Q48,-2 52,4 Q54,10 54,20 L54,42
                    L56,18 Q56,4 60,-2 Q64,-6 68,-2 Q72,4 72,18 L70,42
                    L74,24 Q76,10 80,6 Q84,2 88,8 Q92,14 90,28 L86,48
                    L90,40 Q94,32 98,32 Q102,34 104,40 Q106,48 102,60 L96,76
                    Q90,96 86,108
                    Q82,118 78,122
                    L78,130 L78,170
                    Z"
                    fill="url(#handG1)" filter="url(#hs1)"/>
                <!-- Highlight on palm/fingers -->
                <path d="
                    M48,165 L48,128
                    Q48,120 46,116
                    L44,60 Q44,30 48,14
                    Q50,8 54,20 L54,42
                    L56,18 Q58,8 62,4 Q66,2 68,10 L68,42
                    L72,24 Q74,14 78,12 Q82,10 84,18 L84,48
                    L88,40 Q92,36 96,38 Q100,42 98,54 L92,74
                    Q86,94 82,108
                    Q78,118 76,122
                    L76,165
                    Z"
                    fill="url(#handH1)" opacity="0.5"/>
                <!-- Knuckle creases -->
                <path d="M44,52 Q52,56 58,52" stroke="rgba(255,255,255,0.08)" stroke-width="1" fill="none"/>
                <path d="M58,48 Q66,52 74,48" stroke="rgba(255,255,255,0.08)" stroke-width="1" fill="none"/>
                <path d="M74,54 Q80,58 88,54" stroke="rgba(255,255,255,0.08)" stroke-width="1" fill="none"/>
                <!-- Wrist strap detail -->
                <rect x="42" y="125" width="36" height="6" rx="2" fill="rgba(255,255,255,0.06)"/>
            </svg>
        </div>

        <!-- Hand P2 (Bottom) - Same unified design -->
        <div class="hand p2-hand" id="p2Hand">
            <svg viewBox="0 0 120 170" fill="none">
                <defs>
                    <linearGradient id="handG2" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#2a2520"/>
                        <stop offset="50%" stop-color="#1e1a17"/>
                        <stop offset="100%" stop-color="#141210"/>
                    </linearGradient>
                    <linearGradient id="handH2" x1="20%" y1="0%" x2="80%" y2="100%">
                        <stop offset="0%" stop-color="rgba(255,255,255,0.12)"/>
                        <stop offset="100%" stop-color="rgba(255,255,255,0.02)"/>
                    </linearGradient>
                    <filter id="hs2"><feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#000" flood-opacity="0.4"/></filter>
                </defs>
                <path d="
                    M42,170 L42,130
                    Q42,118 42,115
                    L36,115 Q22,112 18,100 Q14,88 20,72
                    L22,62 Q26,52 30,50 Q36,46 40,52 L42,60
                    L42,44 Q42,20 38,12 Q36,4 42,0 Q48,-2 52,4 Q54,10 54,20 L54,42
                    L56,18 Q56,4 60,-2 Q64,-6 68,-2 Q72,4 72,18 L70,42
                    L74,24 Q76,10 80,6 Q84,2 88,8 Q92,14 90,28 L86,48
                    L90,40 Q94,32 98,32 Q102,34 104,40 Q106,48 102,60 L96,76
                    Q90,96 86,108
                    Q82,118 78,122
                    L78,130 L78,170
                    Z"
                    fill="url(#handG2)" filter="url(#hs2)"/>
                <path d="
                    M48,165 L48,128
                    Q48,120 46,116
                    L44,60 Q44,30 48,14
                    Q50,8 54,20 L54,42
                    L56,18 Q58,8 62,4 Q66,2 68,10 L68,42
                    L72,24 Q74,14 78,12 Q82,10 84,18 L84,48
                    L88,40 Q92,36 96,38 Q100,42 98,54 L92,74
                    Q86,94 82,108
                    Q78,118 76,122
                    L76,165
                    Z"
                    fill="url(#handH2)" opacity="0.5"/>
                <path d="M44,52 Q52,56 58,52" stroke="rgba(255,255,255,0.08)" stroke-width="1" fill="none"/>
                <path d="M58,48 Q66,52 74,48" stroke="rgba(255,255,255,0.08)" stroke-width="1" fill="none"/>
                <path d="M74,54 Q80,58 88,54" stroke="rgba(255,255,255,0.08)" stroke-width="1" fill="none"/>
                <rect x="42" y="125" width="36" height="6" rx="2" fill="rgba(255,255,255,0.06)"/>
            </svg>
        </div>

        <!-- Diamond Glow -->
        <div class="diamond-glow" id="diamondGlow"></div>

        <!-- Display Case with Diamond Ring -->
        <div class="display-case">
            <svg viewBox="0 0 240 200" id="displaySvg">
                <defs>
                    <radialGradient id="glassR" cx="50%" cy="45%" r="55%">
                        <stop offset="0%" style="stop-color:rgba(220,240,255,0.04)"/>
                        <stop offset="70%" style="stop-color:rgba(200,225,245,0.1)"/>
                        <stop offset="100%" style="stop-color:rgba(180,210,235,0.18)"/>
                    </radialGradient>
                    <linearGradient id="baseG" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#505050"/>
                        <stop offset="30%" style="stop-color:#353535"/>
                        <stop offset="100%" style="stop-color:#1a1a1a"/>
                    </linearGradient>
                    <radialGradient id="velvetR" cx="50%" cy="50%" r="50%">
                        <stop offset="0%" style="stop-color:#3a1828"/>
                        <stop offset="60%" style="stop-color:#251018"/>
                        <stop offset="100%" style="stop-color:#180a10"/>
                    </radialGradient>
                    <linearGradient id="diaTop" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#e8f8ff"/>
                        <stop offset="40%" style="stop-color:#a0dcf8"/>
                        <stop offset="100%" style="stop-color:#60b0e0"/>
                    </linearGradient>
                    <linearGradient id="diaBotL" x1="100%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#4898c8"/>
                        <stop offset="100%" style="stop-color:#185880"/>
                    </linearGradient>
                    <linearGradient id="diaBotR" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#3888b8"/>
                        <stop offset="100%" style="stop-color:#104870"/>
                    </linearGradient>
                    <linearGradient id="goldG" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffe566"/>
                        <stop offset="25%" style="stop-color:#ffd700"/>
                        <stop offset="50%" style="stop-color:#e6b800"/>
                        <stop offset="75%" style="stop-color:#cc9900"/>
                        <stop offset="100%" style="stop-color:#aa7700"/>
                    </linearGradient>
                    <linearGradient id="goldShine" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#aa7700"/>
                        <stop offset="35%" style="stop-color:#ffd700"/>
                        <stop offset="65%" style="stop-color:#ffe566"/>
                        <stop offset="100%" style="stop-color:#cc9900"/>
                    </linearGradient>
                    <filter id="diaGlow">
                        <feGaussianBlur stdDeviation="3" result="blur"/>
                        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                    <filter id="baseShadow">
                        <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.45"/>
                    </filter>
                    <filter id="ringShadow">
                        <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.35"/>
                    </filter>
                </defs>

                <ellipse cx="120" cy="105" rx="100" ry="70" fill="url(#baseG)" filter="url(#baseShadow)"/>
                <ellipse cx="120" cy="100" rx="98" ry="66" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="1"/>
                <ellipse cx="120" cy="105" rx="86" ry="58" fill="#222"/>
                <ellipse cx="120" cy="105" rx="74" ry="48" fill="url(#velvetR)"/>
                <ellipse cx="120" cy="102" rx="60" ry="38" fill="none" stroke="rgba(80,30,50,0.3)" stroke-width="0.5"/>

                <g id="ringGroup">
                    <ellipse cx="120" cy="108" rx="28" ry="16" fill="none" stroke="url(#goldG)" stroke-width="6" filter="url(#ringShadow)"/>
                    <ellipse cx="120" cy="109" rx="24" ry="13" fill="none" stroke="rgba(170,120,0,0.5)" stroke-width="1.5"/>
                    <ellipse cx="120" cy="107" rx="28" ry="16" fill="none" stroke="url(#goldShine)" stroke-width="1.5" opacity="0.6"/>
                    <ellipse cx="120" cy="112" rx="20" ry="10" fill="none" stroke="rgba(0,0,0,0.2)" stroke-width="2"/>

                    <line x1="106" y1="96" x2="110" y2="82" stroke="url(#goldG)" stroke-width="3" stroke-linecap="round"/>
                    <line x1="134" y1="96" x2="130" y2="82" stroke="url(#goldG)" stroke-width="3" stroke-linecap="round"/>
                    <line x1="114" y1="94" x2="116" y2="80" stroke="url(#goldG)" stroke-width="2.5" stroke-linecap="round"/>
                    <line x1="126" y1="94" x2="124" y2="80" stroke="url(#goldG)" stroke-width="2.5" stroke-linecap="round"/>

                    <g filter="url(#diaGlow)">
                        <polygon points="120,48 148,78 120,92 92,78" fill="url(#diaTop)"/>
                        <polygon points="120,52 140,74 120,84 100,74" fill="rgba(255,255,255,0.35)"/>
                        <polygon points="120,52 100,74 92,78" fill="rgba(100,180,230,0.5)" opacity="0.7"/>
                        <polygon points="120,52 140,74 148,78" fill="rgba(70,150,210,0.5)" opacity="0.6"/>
                        <polygon points="92,78 120,92 120,110" fill="url(#diaBotL)"/>
                        <polygon points="148,78 120,92 120,110" fill="url(#diaBotR)"/>
                        <polygon points="120,60 130,76 120,86 110,76" fill="rgba(255,255,255,0.2)"/>
                        <circle cx="106" cy="62" r="3.5" fill="white" opacity="0.9"/>
                        <circle cx="112" cy="56" r="1.8" fill="white" opacity="0.7"/>
                        <circle cx="100" cy="70" r="1.2" fill="white" opacity="0.5"/>
                        <circle cx="136" cy="68" r="1" fill="white" opacity="0.4"/>
                    </g>
                </g>

                <g class="glass-group" id="glassGroup">
                    <ellipse cx="120" cy="100" rx="80" ry="56" fill="url(#glassR)"/>
                    <ellipse cx="120" cy="100" rx="80" ry="56" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="2"/>
                    <ellipse cx="96" cy="78" rx="32" ry="22" fill="none" stroke="rgba(255,255,255,0.22)" stroke-width="6" stroke-linecap="round" transform="rotate(-12 96 78)"/>
                    <ellipse cx="100" cy="82" rx="22" ry="14" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="3" transform="rotate(-12 100 82)"/>
                    <path d="M155,88 Q165,100 155,118" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="3.5" stroke-linecap="round"/>
                </g>
            </svg>
        </div>

        <div class="round-flash" id="roundFlash"></div>
        <div class="particle-container" id="particles"></div>
    </div>

    <!-- Game Over -->
    <div class="game-over" id="gameOver">
        <div class="winner-crown">&#128081;</div>
        <h2 class="winner-title" id="winnerTitle">PLAYER 1 WINS</h2>
        <div class="final-score" id="finalScore">5 - 3</div>
        <button class="start-btn" id="playAgainBtn">PLAY AGAIN</button>
    </div>

    <script>
        const CONFIG = {
            WINNING_SCORE: 5,
            GRAB_TIMEOUT: 4000,
            PENALTY_DURATION: 1800,
            NEXT_ROUND_DELAY: 1000,
            GRAB_DURATION: 180,
            RETRACT_DURATION: 1800
        };

        function getRandomWaitTime() {
            const roll = Math.random() * 100;
            if (roll < 5) return 1000 + Math.random() * 2000;
            if (roll < 30) return 8000 + Math.random() * 7000;
            return 3000 + Math.random() * 5000;
        }

        let state = 'idle';
        let scores = { p1: 0, p2: 0 };
        let waitTimer = null;
        let p1CanGrab = true;
        let p2CanGrab = true;

        const el = {
            startScreen: document.getElementById('startScreen'),
            startBtn: document.getElementById('startBtn'),
            p1Zone: document.getElementById('p1Zone'),
            p2Zone: document.getElementById('p2Zone'),
            p1Hand: document.getElementById('p1Hand'),
            p2Hand: document.getElementById('p2Hand'),
            p1Penalty: document.getElementById('p1Penalty'),
            p2Penalty: document.getElementById('p2Penalty'),
            glassGroup: document.getElementById('glassGroup'),
            ringGroup: document.getElementById('ringGroup'),
            diamondGlow: document.getElementById('diamondGlow'),
            p1Score: document.getElementById('p1Score'),
            p2Score: document.getElementById('p2Score'),
            roundFlash: document.getElementById('roundFlash'),
            particles: document.getElementById('particles'),
            gameOver: document.getElementById('gameOver'),
            winnerTitle: document.getElementById('winnerTitle'),
            finalScore: document.getElementById('finalScore'),
            playAgainBtn: document.getElementById('playAgainBtn'),
            exitBtn: document.getElementById('exitBtn')
        };

        function init() {
            el.startBtn.addEventListener('click', startGame);
            el.startBtn.addEventListener('touchend', e => { e.preventDefault(); startGame(); });
            el.playAgainBtn.addEventListener('click', resetGame);
            el.playAgainBtn.addEventListener('touchend', e => { e.preventDefault(); resetGame(); });
            el.exitBtn.addEventListener('click', exitToMenu);
            el.exitBtn.addEventListener('touchend', e => { e.preventDefault(); exitToMenu(); });
            el.p1Zone.addEventListener('touchstart', e => { e.preventDefault(); handleTap(1); }, { passive: false });
            el.p1Zone.addEventListener('mousedown', () => handleTap(1));
            el.p2Zone.addEventListener('touchstart', e => { e.preventDefault(); handleTap(2); }, { passive: false });
            el.p2Zone.addEventListener('mousedown', () => handleTap(2));
        }

        function startGame() {
            el.startScreen.classList.add('hidden');
            scores = { p1: 0, p2: 0 };
            updateScores();
            startRound();
        }

        function resetGame() {
            el.gameOver.classList.remove('show');
            scores = { p1: 0, p2: 0 };
            updateScores();
            startRound();
        }

        function exitToMenu() {
            clearTimeout(waitTimer);
            state = 'idle';
            el.gameOver.classList.remove('show');
            el.startScreen.classList.remove('hidden');
        }

        function startRound() {
            state = 'waiting';
            p1CanGrab = true;
            p2CanGrab = true;
            resetHands();
            el.ringGroup.style.opacity = '1';
            el.ringGroup.style.transform = '';
            el.glassGroup.classList.remove('hidden');
            el.diamondGlow.classList.remove('hidden');
            waitTimer = setTimeout(() => { openCase(); }, getRandomWaitTime());
        }

        function openCase() {
            state = 'grab';
            el.glassGroup.classList.add('hidden');
            if (navigator.vibrate) navigator.vibrate(50);
            waitTimer = setTimeout(() => { if (state === 'grab') startRound(); }, CONFIG.GRAB_TIMEOUT);
        }

        function handleTap(player) {
            const canGrab = player === 1 ? p1CanGrab : p2CanGrab;
            if (!canGrab) return;
            if (state === 'waiting') applyPenalty(player);
            else if (state === 'grab') grabDiamond(player);
        }

        function applyPenalty(player) {
            const hand = player === 1 ? el.p1Hand : el.p2Hand;
            const penalty = player === 1 ? el.p1Penalty : el.p2Penalty;
            if (player === 1) p1CanGrab = false; else p2CanGrab = false;
            penalty.classList.add('show');
            hand.classList.add('grabbing');
            if (navigator.vibrate) navigator.vibrate([30, 30, 30]);
            setTimeout(() => penalty.classList.remove('show'), 500);
            setTimeout(() => {
                hand.classList.remove('grabbing');
                hand.classList.add('retracting');
                setTimeout(() => {
                    hand.classList.remove('retracting');
                    if (player === 1) p1CanGrab = true; else p2CanGrab = true;
                }, CONFIG.PENALTY_DURATION);
            }, CONFIG.GRAB_DURATION);
        }

        function grabDiamond(player) {
            if (state !== 'grab') return;
            state = 'scored';
            clearTimeout(waitTimer);
            const hand = player === 1 ? el.p1Hand : el.p2Hand;
            hand.classList.add('grabbing');
            setTimeout(() => {
                el.ringGroup.style.transition = 'all 0.15s ease-out';
                el.ringGroup.style.opacity = '0';
                el.ringGroup.style.transform = 'scale(0.5)';
                el.diamondGlow.classList.add('hidden');
                createParticles(player);
                if (player === 1) scores.p1++; else scores.p2++;
                updateScores();
                el.roundFlash.className = 'round-flash ' + (player === 1 ? 'p1-win' : 'p2-win');
                if (navigator.vibrate) navigator.vibrate(100);
                setTimeout(() => {
                    el.roundFlash.className = 'round-flash';
                    if (scores.p1 >= CONFIG.WINNING_SCORE || scores.p2 >= CONFIG.WINNING_SCORE) showGameOver();
                    else startRound();
                }, CONFIG.NEXT_ROUND_DELAY);
            }, CONFIG.GRAB_DURATION);
        }

        function createParticles(player) {
            el.particles.innerHTML = '';
            const colors = player === 1 ? ['#7ac4ff', '#b8ecff', '#5098d9'] : ['#ff7a7a', '#ffb8b8', '#d95050'];
            for (let i = 0; i < 12; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.background = colors[i % 3];
                p.style.setProperty('--tx', (Math.random() - 0.5) * 150 + 'px');
                p.style.setProperty('--ty', (Math.random() - 0.5) * 150 + 'px');
                el.particles.appendChild(p);
                setTimeout(() => p.classList.add('animate'), 10);
            }
        }

        function showGameOver() {
            state = 'gameover';
            const winner = scores.p1 > scores.p2 ? 1 : 2;
            el.winnerTitle.textContent = `PLAYER ${winner} WINS`;
            el.winnerTitle.className = 'winner-title p' + winner;
            el.finalScore.textContent = `${scores.p1} - ${scores.p2}`;
            el.gameOver.classList.add('show');
        }

        function resetHands() {
            el.p1Hand.classList.remove('grabbing', 'retracting');
            el.p2Hand.classList.remove('grabbing', 'retracting');
        }

        function updateScores() {
            el.p1Score.textContent = scores.p1;
            el.p2Score.textContent = scores.p2;
        }

        init();
    </script>
</body>
</html>